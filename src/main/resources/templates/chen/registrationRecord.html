<!DOCTYPE html>


<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">


    <title>GoodGames | Faker</title>

    <meta name="description" content="GoodGames - Bootstrap template for communities and games store">
    <meta name="keywords" content="game, gaming, template, HTML template, responsive, Bootstrap, premium">
    <meta name="author" content="_nK">

    <link rel="icon" type="image/png" th:href="@{/assets/images/favicon.png}">

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- START: Styles -->

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7cOpen+Sans:400,700" rel="stylesheet"
        type="text/css">

    <!-- Bootstrap -->
    <link rel="stylesheet" th:href="@{/assets/vendor/bootstrap/dist/css/bootstrap.min.css}">

    <!-- FontAwesome -->
    <script defer th:src="@{/assets/vendor/fontawesome-free/js/all.js}"></script>
    <script defer th:src="@{/assets/vendor/fontawesome-free/js/v4-shims.js}"></script>

    <!-- IonIcons -->
    <link rel="stylesheet" th:href="@{/assets/vendor/ionicons/css/ionicons.min.css}">

    <!-- Flickity -->
    <link rel="stylesheet" th:href="@{/assets/vendor/flickity/dist/flickity.min.css}">

    <!-- Photoswipe -->
    <link rel="stylesheet" type="text/css" th:href="@{/assets/vendor/photoswipe/dist/photoswipe.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/vendor/photoswipe/dist/default-skin/default-skin.css}">

    <!-- Seiyria Bootstrap Slider -->
    <link rel="stylesheet" th:href="@{/assets/vendor/bootstrap-slider/dist/css/bootstrap-slider.min.css}">

    <!-- Summernote -->
    <link rel="stylesheet" type="text/css" th:href="@{/assets/vendor/summernote/dist/summernote-bs4.css}">

    <!-- GoodGames -->
    <link rel="stylesheet" th:href="@{/assets/css/goodgames.css}">

    <!-- Custom Styles -->
    <link rel="stylesheet" th:href="@{/assets/css/custom.css}">

    <!-- END: Styles -->

    <!-- jQuery -->
    <script th:src="@{/assets/vendor/jquery/dist/jquery.min.js}"></script>


</head>


<!--
    Additional Classes:
        .nk-page-boxed
-->

<body>
    <div th:replace="${session.memberBeans} ? ~{layout/navHomeLogin} : ~{layout/navHome} "></div>





    <!--
    Additional Classes:
        .nk-header-opaque
-->
    <header class="nk-header nk-header-opaque">








    </header>



    <!--
    START: Navbar Mobile

    Additional Classes:
        .nk-navbar-left-side
        .nk-navbar-right-side
        .nk-navbar-lg
        .nk-navbar-overlay-content
-->
    <div id="nk-nav-mobile" class="nk-navbar nk-navbar-side nk-navbar-right-side nk-navbar-overlay-content d-lg-none">
        <div class="nano">
            <div class="nano-content">
                <a href="index.html" class="nk-nav-logo">
                    <img src="assets/images/logo.png" alt="" width="120">
                </a>
                <div class="nk-navbar-mobile-content">
                    <ul class="nk-nav">
                        <!-- Here will be inserted menu from [data-mobile-menu="#nk-nav-mobile"] -->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- END: Navbar Mobile -->



    <div class="nk-main" style="margin-top:-100px">

        <!-- START: Breadcrumbs -->
        <div class="nk-gap-1"></div>
        <div class="container">
            <ul class="nk-breadcrumbs">





                <li><span>報名紀錄</span></li>

            </ul>
        </div>
        <div class="nk-gap-1"></div>
        <!-- END: Breadcrumbs -->




        <div class="container">

            <!-- START: Products Filter -->
            <div class="nk-gap-2"></div>
            <div class="row vertical-gap">
                <div class="col-lg-8">
                    <div class="row vertical-gap">
                        <div class="col-md-8">
                            <div class="nk-input-slider-inline">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="input-group">
                        <input id="eventName" type="text" class="form-control" name="eventName"
                            placeholder="Type something...">
                        <input id="memberIdd" type="hidden" th:value="${session.memberBeans?.id}" />
                        <button class="nk-btn nk-btn-color-main-1" onclick="searchRegistrationRecord()"><span
                                class="ion-search"></span></button>
                    </div>
                </div>
            </div>
            <!-- END: Products Filter -->

            <div class="nk-gap-2"></div>
            <!-- START: Products -->
            <div id="registrationRecordContainer" class="row vertical-gap">

                <th:block th:each=" record : ${recordList}">
                    <div class="col-lg-12">
                        <div class="nk-product-cat-2">
                            <span style="width: 350px;height: 300px;align-self: center !important;"
                                class="nk-product-image">
                                <img style="width: 350px;height: 300px;"
                                    th:src="@{'/eventRegistration/showImage/'+${record.event.eventId}}"
                                    alt="So saying he unbuckled">
                            </span>
                            <div class="nk-product-cont" style="position: relative;">
                                <h3 class="nk-product-title" th:text="${record.event.name}"></h3>
                                <div class="nk-gap"></div>
                                <div class="nk-product-rating" data-rating="4"> <i class="fa fa-star"></i> <i
                                        class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i
                                        class="far fa-star"></i></div>
                                <div class="nk-gap"></div>
                                <div th:text="${record.event.description}"></div>
                                <div class="nk-gap"></div>
                                <div th:text="'地點:'+${record.event.location}"></div>
                                <div class="nk-gap"></div>
                                <div th:text="'開始日期:'+${record.event.startDate}"></div>
                                <div th:text="'結束日期:'+${record.event.endDate}"></div>
                                <form th:action="@{/registrationRecord/delete}" th:method="delete">
                                    <button style="position: absolute;right: 0;bottom: 0;font-size: 30px"
                                        class="nk-btn nk-btn-rounded nk-btn-color-dark-3 nk-btn-hover-color-main-1 delete-btn">取消報名</button>
                                    <input type="hidden" name="signupId" th:value="${record.signupId}" />
                                    <input type="hidden" name="memberId" th:value="${session.memberBeans?.id}" />
                                </form>
                            </div>
                        </div>
                    </div>
                </th:block>

                <!-- END: Products -->

                <!-- START: Pagination 
    <div class="nk-gap-3"></div>
    <div class="nk-pagination nk-pagination-center">
        <a href="#" class="nk-pagination-prev">
            <span class="ion-ios-arrow-back"></span>
        </a>
        <nav>
            <a class="nk-pagination-current" href="#">1</a>
            <a href="#">2</a>
            <a href="#">3</a>
            <a href="#">4</a>
            <span>...</span>
            <a href="#">14</a>
        </nav>
        <a href="#" class="nk-pagination-next">
            <span class="ion-ios-arrow-forward"></span>
        </a>
    </div>
    END: Pagination -->

                <!-- START: Most Popular -->
                <div class="nk-gap-3"></div>
                <h3 class="nk-decorated-h-2"><span><span class="text-main-1">熱門</span> 遊戲</span></h3>
                <div class="nk-gap"></div>
                <div class="row vertical-gap">


                    <div class="col-lg-4 col-md-6">
                        <div class="nk-product-cat">
                            <a class="nk-product-image" href="store-product.html">
                                <img src="assets/images/product-11-xs.jpg" alt="She gave my mother">
                            </a>
                            <div class="nk-product-cont">
                                <h3 class="nk-product-title h5"><a href="store-product.html">She gave my mother</a></h3>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-rating" data-rating="3"> <i class="fa fa-star"></i> <i
                                        class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="far fa-star"></i>
                                    <i class="far fa-star"></i>
                                </div>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-price">€ 14.00</div>
                            </div>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6">
                        <div class="nk-product-cat">
                            <a class="nk-product-image" href="store-product.html">
                                <img src="assets/images/product-12-xs.jpg" alt="A hundred thousand">
                            </a>
                            <div class="nk-product-cont">
                                <h3 class="nk-product-title h5"><a href="store-product.html">A hundred thousand</a></h3>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-rating" data-rating="4.5"> <i class="fa fa-star"></i> <i
                                        class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i
                                        class="fas fa-star-half"></i></div>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-price">€ 20.00</div>
                            </div>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6">
                        <div class="nk-product-cat">
                            <a class="nk-product-image" href="store-product.html">
                                <img src="assets/images/product-13-xs.jpg" alt="So saying he unbuckled">
                            </a>
                            <div class="nk-product-cont">
                                <h3 class="nk-product-title h5"><a href="store-product.html">So saying he unbuckled</a>
                                </h3>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-rating" data-rating="5"> <i class="fa fa-star"></i> <i
                                        class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i
                                        class="fa fa-star"></i></div>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-price">€ 23.00</div>
                            </div>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6">
                        <div class="nk-product-cat">
                            <a class="nk-product-image" href="store-product.html">
                                <img src="assets/images/product-14-xs.jpg" alt="However, I have reason">
                            </a>
                            <div class="nk-product-cont">
                                <h3 class="nk-product-title h5"><a href="store-product.html">However, I have reason</a>
                                </h3>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-rating" data-rating="1.5"> <i class="fa fa-star"></i> <i
                                        class="fas fa-star-half"></i> <i class="far fa-star"></i> <i
                                        class="far fa-star"></i> <i class="far fa-star"></i></div>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-price">€ 32.00</div>
                            </div>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6">
                        <div class="nk-product-cat">
                            <a class="nk-product-image" href="store-product.html">
                                <img src="assets/images/product-15-xs.jpg" alt="At first, for some time">
                            </a>
                            <div class="nk-product-cont">
                                <h3 class="nk-product-title h5"><a href="store-product.html">At first, for some time</a>
                                </h3>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-rating" data-rating="4"> <i class="fa fa-star"></i> <i
                                        class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i
                                        class="far fa-star"></i></div>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-price">€ 14.00</div>
                            </div>
                        </div>
                    </div>


                    <div class="col-lg-4 col-md-6">
                        <div class="nk-product-cat">
                            <a class="nk-product-image" href="store-product.html">
                                <img src="assets/images/product-16-xs.jpg" alt="When the last &#39;natural&#39;">
                            </a>
                            <div class="nk-product-cont">
                                <h3 class="nk-product-title h5"><a href="store-product.html">When the last
                                        &#39;natural&#39;</a></h3>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-rating" data-rating="4.5"> <i class="fa fa-star"></i> <i
                                        class="fa fa-star"></i> <i class="fa fa-star"></i> <i class="fa fa-star"></i> <i
                                        class="fas fa-star-half"></i></div>
                                <div class="nk-gap-1"></div>
                                <div class="nk-product-price">€ 20.00</div>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- END: Most Popular -->
            </div>

            <div class="nk-gap-2"></div>




        </div>
        <div th:replace="~{layout/footer}"></div>




        <!-- START: Page Background -->

        <img class="nk-page-background-top" src="assets/images/bg-top-4.png" alt="">
        <img class="nk-page-background-bottom" src="assets/images/bg-bottom.png" alt="">

        <!-- END: Page Background -->




        <!-- START: Search Modal -->
        <div class="nk-modal modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-sm" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span class="ion-android-close"></span>
                        </button>

                        <h4 class="mb-0">Search</h4>

                        <div class="nk-gap-1"></div>
                        <form action="#" class="nk-form nk-form-style-1">
                            <input type="text" value="" name="search" class="form-control"
                                placeholder="Type something and press Enter" autofocus>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- END: Search Modal -->



        <!-- START: Login Modal -->
        <div class="nk-modal modal fade" id="modalLogin" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-sm" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span class="ion-android-close"></span>
                        </button>

                        <h4 class="mb-0"><span class="text-main-1">Sign</span> In</h4>

                        <div class="nk-gap-1"></div>
                        <form action="#" class="nk-form text-white">
                            <div class="row vertical-gap">
                                <div class="col-md-6">
                                    Use email and password:

                                    <div class="nk-gap"></div>
                                    <input type="email" value="" name="email" class=" form-control" placeholder="Email">

                                    <div class="nk-gap"></div>
                                    <input type="password" value="" name="password" class="required form-control"
                                        placeholder="Password">
                                </div>
                                <div class="col-md-6">
                                    Or social account:

                                    <div class="nk-gap"></div>

                                    <ul class="nk-social-links-2">
                                        <li><a class="nk-social-facebook" href="#"><span
                                                    class="fab fa-facebook"></span></a></li>
                                        <li><a class="nk-social-google-plus" href="#"><span
                                                    class="fab fa-google-plus"></span></a></li>
                                        <li><a class="nk-social-twitter" href="#"><span
                                                    class="fab fa-twitter"></span></a></li>
                                    </ul>
                                </div>
                            </div>

                            <div class="nk-gap-1"></div>
                            <div class="row vertical-gap">
                                <div class="col-md-6">
                                    <a href="#" class="nk-btn nk-btn-rounded nk-btn-color-white nk-btn-block">Sign
                                        In</a>
                                </div>
                                <div class="col-md-6">
                                    <div class="mnt-5">
                                        <small><a href="#">Forgot your password?</a></small>
                                    </div>
                                    <div class="mnt-5">
                                        <small><a href="#">Not a member? Sign up</a></small>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- END: Login Modal -->




        <!-- START: Scripts -->

        <!-- Object Fit Polyfill -->
        <script th:src="@{/assets/vendor/object-fit-images/dist/ofi.min.js}"></script>

        <!-- GSAP -->
        <script th:src="@{/assets/vendor/gsap/src/minified/TweenMax.min.js}"></script>
        <script th:src="@{/assets/vendor/gsap/src/minified/plugins/ScrollToPlugin.min.js}"></script>

        <!-- Popper -->
        <script th:src="@{/assets/vendor/popper.js/dist/umd/popper.min.js}"></script>

        <!-- Bootstrap -->
        <script th:src="@{/assets/vendor/bootstrap/dist/js/bootstrap.min.js}"></script>

        <!-- Sticky Kit -->
        <script th:src="@{/assets/vendor/sticky-kit/dist/sticky-kit.min.js}"></script>

        <!-- Jarallax -->
        <script th:src="@{/assets/vendor/jarallax/dist/jarallax.min.js}"></script>
        <script th:src="@{/assets/vendor/jarallax/dist/jarallax-video.min.js}"></script>

        <!-- imagesLoaded -->
        <script th:src="@{/assets/vendor/imagesloaded/imagesloaded.pkgd.min.js}"></script>

        <!-- Flickity -->
        <script th:src="@{/assets/vendor/flickity/dist/flickity.pkgd.min.js}"></script>

        <!-- Photoswipe -->
        <script th:src="@{/assets/vendor/photoswipe/dist/photoswipe.min.js}"></script>
        <script th:src="@{/assets/vendor/photoswipe/dist/photoswipe-ui-default.min.js}"></script>

        <!-- Jquery Validation -->
        <script th:src="@{/assets/vendor/jquery-validation/dist/jquery.validate.min.js}"></script>

        <!-- Jquery Countdown + Moment -->
        <script th:src="@{/assets/vendor/jquery-countdown/dist/jquery.countdown.min.js}"></script>
        <script th:src="@{/assets/vendor/moment/min/moment.min.js}"></script>
        <script th:src="@{/assets/vendor/moment-timezone/builds/moment-timezone-with-data.min.js}"></script>

        <!-- Hammer.js -->
        <script th:src="@{/assets/vendor/hammerjs/hammer.min.js}"></script>

        <!-- NanoSroller -->
        <script th:src="@{/assets/vendor/nanoscroller/bin/javascripts/jquery.nanoscroller.js}"></script>

        <!-- SoundManager2 -->
        <script th:src="@{/assets/vendor/soundmanager2/script/soundmanager2-nodebug-jsmin.js}"></script>

        <!-- Seiyria Bootstrap Slider -->
        <script th:src="@{/assets/vendor/bootstrap-slider/dist/bootstrap-slider.min.js}"></script>

        <!-- Summernote -->
        <script th:src="@{/assets/vendor/summernote/dist/summernote-bs4.min.js}"></script>

        <!-- nK Share -->
        <script th:src="@{/assets/plugins/nk-share/nk-share.js}"></script>

        <!-- GoodGames -->
        <script th:src="@{/assets/js/goodgames.min.js}"></script>
        <script th:src="@{/assets/js/goodgames-init.js}"></script>
        <!-- END: Scripts -->

        <script>
            $(function () {
                $.extend(true, $.fn.dataTable.defaults, {
                    searching: false,
                    ordering: true,
                });

                $(document).ready(function () {
                    $('#example').DataTable();
                });

            })


            $('.delete-btn').click(function (event) {
                event.preventDefault();
                Swal.fire({
                    title: '確定要取消報名嗎?',
                    text: "取消後就要重新報名哦",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: '確定',
                    cancelButtonText: '取消'
                }).then((result) => {
                    if (result.isConfirmed) {
                        $(this).closest('form').find('input[name="signupId"]').val();
                        $(this).closest('form').submit();
                    }
                })
            });
            
           function showImage() {
			    var eventImage = document.getElementById('eventImage');
			    var eventId = document.getElementById('eventId').value;
			
			    var url = 'http://localhost:8080/carbon/eventRegistration/showImage/' + eventId;
			
			    axios.get(url, {
			            responseType: 'arraybuffer' // 指定响应类型为arraybuffer
			        })
			        .then(response => {
			            var imageBlob = new Blob([response.data], { type: response.headers['content-type'] });
			            var imageUrl = URL.createObjectURL(imageBlob);
			            eventImage.src = imageUrl;
			        })
			        .catch(err => {
			            console.log('err: ' + err);
			        });
			}
				
			
            
            
            function searchRegistrationRecord() {
	              var eventName = document.getElementById('eventName').value;
				  var memberId = document.getElementById('memberIdd').value;
	              console.log("eventName: " + eventName);
				  console.log("memberId: " + memberId);
				  
				  let requestData = {
			          params: {
			              eventName: eventName,
	                      memberId: memberId
			          }
			      };
	
	                axios.get('http://localhost:8080/carbon/registrationRecord/category', requestData)
	                    .then(function (response) {
	                        var recordList = response.data;
	                        console.log("recordList: " + JSON.stringify(recordList))
	                        var registrationRecordContainer = document.getElementById('registrationRecordContainer');
	                        registrationRecordContainer.innerHTML = '';
	
	                        recordList.forEach(function (record) {
	                            var html = `
				                <div class="col-lg-12">
				                    <div class="nk-product-cat-2">
				                        <span style="width: 350px;height: 300px;align-self: center !important;" class="nk-product-image">
				                            <img id="eventImage" style="width: 350px; height: 300px;" src="" alt="So saying he unbuckled">
				                        </span>
				                        <div class="nk-product-cont" style="position: relative;">
				                            <h3 class="nk-product-title">${record.name}</h3>
				                            <div class="nk-gap"></div>
				                            <div class="nk-product-rating" data-rating="4">
				                                <i class="fa fa-star"></i>
				                                <i class="fa fa-star"></i>
				                                <i class="fa fa-star"></i>
				                                <i class="fa fa-star"></i>
				                                <i class="far fa-star"></i>
				                            </div>
				                            <div class="nk-gap"></div>
				                            <div>${record.description}</div>
				                            <div class="nk-gap"></div>
				                            <div>地點: ${record.location}</div>
				                            <div class="nk-gap"></div>
				                            <div>開始日期: ${record.startDate}</div>
				                            <div>結束日期: ${record.endDate}</div>
				                            <form action="/registrationRecord/delete" method="post">
				                                <button style="position: absolute;right: 0;bottom: 0;font-size: 30px" class="nk-btn nk-btn-rounded nk-btn-color-dark-3 nk-btn-hover-color-main-1 delete-btn">取消報名</button>
				                            	<input id="eventId" type="hidden" value="${record.eventId}"/>
				                            </form>
				                        </div>
				                    </div>
				                </div>
				            `;
	                            registrationRecordContainer.innerHTML += html;
	                            
	                         showImage();
	                            
	                        });
	                    })
	                    .catch(function (error) {
	                        console.error(error);
	                    });
	            }


           
        </script>



</body>

</html>